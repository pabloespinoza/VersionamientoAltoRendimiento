@model AltoRendimiento.Administracion.Models.ReporteBeneficiarioModel

@{
    ViewBag.Title = "Index";
}

<link href="~/Content/PagedList.css" rel="stylesheet" type="text/css" />

<!-- modal placeholder-->
<div id='myModal' class='modal fade'>
    <div class="modal-dialog modal-lg" style="width: 935px;">
        <div class="modal-content">
            <div id='myModalContent'></div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-md-12">
        <ol class="breadcrumb">
            <li>@Html.ActionLink("Inicio", "Index", "BandejaEntrada")</li>
            <li>Reporte Beneficiarios</li>
        </ol>
    </div>
</div>
<h3>Reporte Beneficiarios</h3>
@if (ViewBag.codResultado == 0)
{
    //Pablo Espinoza - 23-03-2017 - Se reemplaza categoria por concurso
    //Html.ActionLink("Exportar a Excel", "GenerarReporte", "ReporteBeneficiario", new { rutBeneficiario = Model.Rut, idOrganizacion = Model.IdFederacion, idTipoProducto = Model.IdTipoProducto, idTipoBeneficiario = Model.IdTipoBeneficiario, idCategoria = Model.IdCategoria }, new { data_modal = "", id = "btnGenerarReporte", @class = "btn btn-sm btn-info pull-right", @style = "color:White" })
    //Pablo Espinoza - 23-03-2017 - Se reemplaza categoria por concurso
    
    @Html.ActionLink("Exportar a Excel", "GenerarReporte", "ReporteBeneficiario", new { rutBeneficiario = Model.Rut, idOrganizacion = Model.IdFederacion, idTipoProducto = Model.IdTipoProducto, idTipoBeneficiario = Model.IdTipoBeneficiario, idConcurso = Model.IdConcurso }, new { data_modal = "", id = "btnGenerarReporte", @class = "btn btn-sm btn-info pull-right", @style = "color:White" })
}
<br />
<br />
<br />
<div id="divMensaje"></div>

<div class="row">
    <div class="col-md-12">
        <div class="panel panel-default">
            <div class="panel-heading">Reporte Beneficiario</div>
            @using (Html.BeginForm("Index", "ReporteBeneficiario", FormMethod.Get))
            {
                <div class="panel-body">
                    <div class="form-group">
                        @Html.LabelFor(model => model.Rut, new { @class = "control-label col-md-3" })
                        <div class="col-md-3">
                            @Html.TextBoxFor(model => model.Rut, new { @class = "form-control", @placeHolder = "Rut ejemplo :12345678-9", @maxlength = "10" })
                        </div>
                        @Html.LabelFor(model => model.IdTipoBeneficiario, new { @class = "control-label col-md-3" })
                        <div class="col-md-3">
                            @Html.DropDownListFor(model => model.IdTipoBeneficiario, Model.ListaTipoBeneficiario, new { @class = "form-control" })
                        </div>
                    </div>
                    <div class="form-group">
                        @Html.LabelFor(model => model.IdTipoProducto, new { @class = "control-label col-md-3" })
                        <div class="col-md-3">
                            @Html.DropDownListFor(model => model.IdTipoProducto, Model.ListaTipoProducto, "--Seleccione--", new { @class = "form-control" })
                            @Html.ValidationMessageFor(model => model.IdTipoProducto)
                        </div>

                        @*Pablo Espinoza - 23-03-2017 - Se reemplaza categoria por concurso
                            @Html.LabelFor(model => model.IdCategoria, new { @class = "control-label col-md-3" })
                        <div class="col-md-3">
                            @Html.DropDownListFor(model => model.IdCategoria, Model.ListaCategoria, "--Seleccione--", new { @class = "form-control" })
                        </div>*@

                        @Html.LabelFor(model => model.IdConcurso, new { @class = "control-label col-md-3" })
                        <div class="col-md-3">
                            @Html.DropDownListFor(model => model.IdConcurso, Model.ListaConcurso, "--Seleccione--", new { @class = "form-control" })
                        </div>
                    </div>
                    <div class="form-group">
                        @Html.LabelFor(model => model.IdFederacion, new { @class = "control-label col-md-3" })
                        <div class="col-md-3">
                            @Html.DropDownListFor(model => model.IdFederacion, Model.ListaFederacion, "--Seleccione--", new { @class = "form-control" })
                            @Html.ValidationMessageFor(model => model.IdFederacion)
                        </div>
                        <div class="col-md-6 text-right">
                            <button type="submit" id="btnBuscar" class="btn btn-sm btn-danger" data-dismiss="modal">Buscar</button>&nbsp;&nbsp;
                            <a href="ReporteBeneficiario" class="btn btn-sm btn-default">Limpiar</a>
                        </div>
                    </div>
                </div>
            }

        </div>
        @Html.Partial("ListaBeneficiarios", Model)
    </div>
</div>
    @section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
    @Scripts.Render("~/bundles/modalform")
}

<script>
    var codRes = '@(ViewBag.codResultado)';
    var mensajeRespuesta = '@(ViewBag.msgRespuesta)'
    var tipoEstilo = "";
    if (mensajeRespuesta != "") {
        if (codRes == '0') {
            tipoEstilo = "alert-success";
        } else {
            tipoEstilo = "alert-danger";
        }
        var mensajeUsuario = '<div class="alert ' + tipoEstilo + ' alert-dismissable"><button type="button" class="close" data-dismiss="alert">&times;</button>' + mensajeRespuesta + '</div>';
        $("#divMensaje").append(mensajeUsuario);
        if (codRes != '0') {
            $("#tblBeneficiarios").attr("style", "display:none;");
            $("#dvInfoPaginacion").attr("style", "display:none;");
        }
        $("#Rut").focus();
    }

    $('#myModal').on('hidden.bs.modal', function () {
        location.reload();
    })
</script>